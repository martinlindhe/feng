# STATUS: 50%
# format used on dreamcast IP.BIN (game boot executable)

# HI: XXX MAP: U = USA, need eq match on ascii[7]
# MID : interpret ascii[4] CRC as a value for crc calculation comparison
# MID: mark up bootstrap areas as SH-4 binary code in little endian for auto disassembly with capstone or something


references:
  - https://dreamcast.wiki/IP.BIN
  - https://mc.pp.se/dc/ip0000.bin.html

kind: system
name:  Dreamcast disc bootsector
extensions: [.bin]
endian: little

magic:
  - offset: 0000
    match: c'SEGA SEGAKATANA '

structs:
  header:
    ascii[16] HardwareID: c'SEGA SEGAKATANA '
    ascii[16] MakerID: c'SEGA ENTERPRISES'
    ascii[4] CRC: ??
    ascii Padding: c' '
    ascii[6] Device: ?? # "GD-ROM"
    ascii[6] Disc: ?? # "1/1   "
    ascii[7] Region: ??               # XXX MAP: U = USA, J = Japan, E = Europe. need eq match on ascii[7]
    ascii[8] Peripherals: ??
    ascii[10] Product number: ??
    ascii[6] Product version: ??
    ascii[16] Release date: ??    # YYYYMMDD
    ascii[16] Boot file: ??       # usually "1ST_READ.BIN"
    ascii[16] Manufacturer ID: ??
    ascii[128] Software name: ??

    u8[512] Table of contents: ?? # XXX map up
    u8[13312] SEGA license screen code: ??
    u8[256] Area protection symbols: ?? # XXX map up

    u8[10240] Bootstrap 1: ??  # XXX mark as sh4 binary code
    u8[8192] Bootstrap 2: ??

layout:
  - header Meta Information
