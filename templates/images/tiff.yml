# STATUS: 2%

references:
  - https://en.wikipedia.org/wiki/TIFF
  - https://www.sweetscape.com/010editor/repository/files/TIF.bt
  - https://github.com/HexFiend/HexFiend/blob/master/templates/Images/TIFF.tcl

kind: image
extensions: [.tiff, .tif]
mime: image/tiff
endian: little

structs:
  header:
    u16 EndianMarker:
      eq c'MM': BIG_ENDIAN
      eq c'II': LITTLE_ENDIAN

    if self.EndianMarker == BIG_ENDIAN:
      endian: big
    if self.EndianMarker == LITTLE_ENDIAN:
      endian: little

    # invalidate file not matching signature
    if !self.EndianMarker in {BIG_ENDIAN, LITTLE_ENDIAN}:
      data: invalid

    u16 Signature: 00 2a # should decode the same due to endian directive above

    # XXX rest

layout:
  - header Header
