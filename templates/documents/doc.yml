# STATUS: 5%
#
# HI: guid data type
# HI: indistinguish from doc and pps files

references:
  - https://www.sweetscape.com/010editor/repository/files/DOC.bt
  - https://msdn.microsoft.com/en-us/library/office/cc313106

kind: document
# .doc = Microsoft Word Document
# .pps = Microsoft PowerPoint Slideshow
# .ppt = Microsoft PowerPoint presentation
# .pot = Microsoft PowerPoint template
# .xls = Microsoft Excel Spreadsheet
name: Microsoft Office Document
extensions: [.doc, .pps, .ppt, .xls]
# XXX .pps, .ppt, .pot mime: application/vnd.ms-powerpoint
endian: little

magic:
  - offset: 0000
    match: D0 CF 11 E0 A1 B1 1A E1

structs:
  header:
    u8[8] Signature: D0 CF 11 E0 A1 B1 1A E1
    u8[16] GUID: ?? # XXX null guid
    u16 Minor version: ??
    u16 DLL version: ??
    u16 Byte order: ?? # XXX decode. FFFE = ?
    u16 sectorShift: ??
    u16 miniSecShift: ??
    u16 Reserved: ??
    u32 Reserved: ??
    u32 numDirSectors: ?? # FSINDEX xxx
    u32 numFatSectors: ??
    u32 dirSect1: ??
    u32 transactSig: ??
    u32 miniStrMax: ??
    u32 miniFatSect1: ??
    u32 numMniFatSects: ??
    u32 difatSect1: ??
    i32 numDifatSects: ??   # XXX i32 doesnt print negative value

layout:
  - header Header
